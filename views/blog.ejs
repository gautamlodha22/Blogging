<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <title><%= blog.title %></title>
</head>
<body class="bg-gray-100">

  <div class="max-w-4xl mx-auto p-6 mt-10 bg-white rounded-2xl shadow-xl space-y-8">
    <!-- Title -->
    <h1 class="text-4xl font-bold text-gray-900 border-b pb-4">
      <%= blog.title %>
    </h1>

    <!-- Cover Image -->
    <img 
      src="<%= blog.coverImageURL %>" 
      alt="Cover Image"
      class="w-full h-auto rounded-xl shadow-md object-cover"
    />

    <!-- Blog Body -->
    <div class="prose prose-lg text-gray-800 max-w-none">
      <pre class="whitespace-pre-wrap font-sans"><%= blog.body %></pre>
    </div>

    <!-- Author Info -->
    <% if (blog.createdBy) { %>
    <div class="flex items-center gap-4 pt-6 border-t">
      <img 
        src="<%= blog.createdBy.profileImageUrl || '/images/defaultuser.jpg' %>" 
        alt="Author" 
        class="w-14 h-14 rounded-full object-cover border"
        onerror="this.src='/images/defaultuser.jpg';"
      />
      <div>
        <h2 class="text-lg font-semibold text-gray-900"><%= blog.createdBy.fullName %></h2>
        <p class="text-sm text-gray-500">Author â€¢ <%= new Date(blog.createdAt).toDateString() %></p>
      </div>
    </div>

    <% } %>
    <!-- Comments Section -->
<div class="pt-10 border-t">
  <h2 class="text-2xl font-bold text-gray-800 mb-4">Comments</h2>

  <!-- Existing Comments -->
  <% if (comment && comment.length > 0) { %>
    <div class="space-y-6">
      <% comment.forEach(c => { %>
        <div class="border p-4 rounded-lg bg-gray-50">
          <div class="flex items-center gap-3 mb-2">
            <img 
              src="<%= c.createdBy?.profileImageUrl || '/images/defaultuser.jpg' %>" 
              alt="User"
              class="w-10 h-10 rounded-full object-cover border"
              onerror="this.src='/images/defaultuser.jpg';"
            />
            <div>
              <p class="font-semibold"><%= c.createdBy?.fullName || 'Anonymous' %></p>
              <p class="text-sm text-gray-500"><%= new Date(c.createdAt).toDateString() %></p>
            </div>
          </div>
          <p class="text-gray-800"><%= c.content %></p>
        </div>
      <% }) %>
    </div>
  <% } else { %>
    <p class="text-gray-500">No comments yet.</p>
  <% } %>

  <!-- Comment Form (only for logged-in users) -->
  <% if (user) { %>
    <form action="/blog/comment/<%= blog._id %>" method="POST" class="space-y-4 mt-6">
      <textarea name="content" rows="4" required placeholder="Write a comment..." 
        class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
      <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
        Post Comment
      </button>
    </form>
  <% } else { %>
    <p class="text-sm text-blue-600 mt-6">Please <a href="/user/signin" class="underline">log in</a> to post a comment.</p>
  <% } %>
</div>
  
</body>
</html>
